async function y(n){for(let e of n){let o;if(e.src){let m=await fetch(e.src);if(!m.ok)throw new Error(`Failed to load ${e.src}`);o=await m.text()}else o=e.textContent;let r=e.src?e.src.split("/").slice(-1)[0]:"inline script",l=e.src?e.src.split("/").slice(0,-1).join("/"):location.href.split("/").slice(0,-1).join("/"),t=await window.transpileCode(o,l,r);$(t)}}window.processScripts=y;window.import=async function(n){console.log("~~~~ window.import: ",n);let e=n.split("/").slice(0,-1).join("/"),o=await fetch(n);if(!o.ok)throw new Error(`Failed to load ${n}`);let r=await o.text(),l=await window.transpileCode(r,e),t=new Blob([l],{type:"application/javascript"});return await import(URL.createObjectURL(t))};var T=[];function $(n){console.log("inserting");let e=document.createElement("script");e.type="module",e.textContent=n,e.onload=()=>{console.log("Script executed successfully")},e.onerror=o=>{console.log("Script failed to execute:",o)},document.body.appendChild(e)}async function w(n,e,o){console.log("handleImports:",o);let r=n.split(`
`),l=[];for(let t of r)if(t.includes("import")){if(t.trim().startsWith("//")){l.push(t);continue}let u=t.trim().split(" "),i=u.at(-1).replaceAll(/['";]/g,""),J=i.split("/").slice(-1)[0],g=!1,b=!1,f=!1,p=[];if(u.map(s=>(s=s.trim().replaceAll(/['";]/g,"").replaceAll(",",""),g||["import"].includes(s)?!1:["}","from"].includes(s)?(g=!0,!1):s=="{"?(b=!0,!1):(T.push(s),b?p.push(s):f=s,s))).filter(Boolean).length==0)continue;let S=f&&p.length>0?`${f}, {${p.join(", ")}}`:"";if(t.includes("import(")){l.push(t);continue}if(S)t=`import ${S} from '${i}'`;else if(f&&p.length==0)t=`import ${f} from '${i}'`;else if(p.length>0)t=`import {${p.join(", ")}} from '${i}'`;else{console.log("Transpiler: ERROR: CHECK THIS OUT:",t);continue}if(!t.includes(".")){if(window[u[1]]){console.log(`Transpiler: AlreadyLoaded: Window.${u[1]}`),l.push(t);continue}let c=E(i);if(c){let d=t.replace(new RegExp(i+"(?!.*"+i+")"),c);l.push(d);continue}else{console.log("Transpiler: ERROR2: CHECK THIS OUT:",t);continue}}let C=s=>{let c=s.split("/"),d=[];for(let a of c)a==".."?d.pop():a!="."&&d.push(a);return d.join("/")},j=i.startsWith("."),h=e,x=i.split("/").slice(-1)[0];if(j){let s=`${e}/${i.split("/").slice(0,-1).join("/")}`;i=`${s}/${i.split("/").slice(-1)}`,h=C(s)}if(console.log(`%cTranspiler: Handling : ${i}`,"background: #bada55; color: #222"),t.includes(".js")){let s=await fetch(i);if(!s.ok)throw new Error(`Failed to load ${i}`);let c=await s.text();if(t.includes(".jsx")){console.log("Transpiling JSX:",t);let a=await w(c,h,x);l.push(a)}else{console.log("Transpiling JS:",t);let a=await w(c,h,x);l.push(a)}}}else l.push(t);return l.join(`
`)}function E(n){let e=document.querySelector('script[type="importmap"]');if(!e)return!1;try{let o=JSON.parse(e.textContent);return o.imports&&o.imports[n]}catch(o){return console.error("Error parsing import map:",o),!1}}async function L(n,e,o){let r=await w(n,e,o);return console.log("transpileCode...",o),Babel.transform(r,{presets:["react",["env",{modules:!1}]]}).code}window.transpileCode=L;async function R(){let n=document.querySelector('script[src*="bundless.babel"]');if(console.log("Transpiler: Script Tag:",n),!n){console.warn("bundless not found.");return}let e=document.querySelectorAll("script[type='text/jsx'], script[type='text/babel']");if(e.length===0){console.warn("No JSX scripts found.");return}if(document.querySelector('script[src*="babel-standalone"]'))processScripts(e);else{let r=document.createElement("script");r.src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.22.9/babel.min.js",r.onload=()=>processScripts(e),document.head.appendChild(r)}}document.addEventListener("DOMContentLoaded",async()=>{await R()});
